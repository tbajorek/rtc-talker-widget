<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Przykład użycia RTC Talker Widget</title>

    <!-- Bootstrap core CSS -->
    <link href="https://v4-alpha.getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="https://v4-alpha.getbootstrap.com/examples/starter-template/starter-template.css" rel="stylesheet">

    <style>
        .navbar {
            z-index: 130;
        }
        .navbar-nav {
            margin-top: 2px;
        }
        .form-block {
            margin: 15px;
        }
        .widget-settings {
            width: 100%;
            margin-top: 25px;
        }
        .userFromSite {
            margin-top: 35px;
        }
        .form-check-inline {
            margin-right: 35px;
        }
        .lead {
            text-align: left;
        }
        footer {
            text-align: center;
        }
    </style>
</head>

<body>

<nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse fixed-top">
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="#">Przykład</a>

    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="#">Strona główna</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Podstrona 1</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Podstrona 2</a>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Wyszukaj">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Szukaj</button>
        </form>
    </div>
</nav>

<div class="container">
    <div class="starter-template">
        <div class="row form-block">
            <form class="widget-settings">
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="companyId">Identyfikator firmy:</label>
                        <input class="form-control" type="text" id="companyId"/>
                    </div>
                    <div class="form-check col-md-6 userFromSite">
                        <input class="form-check-input" type="checkbox" id="givenUser"/>
                        <label class="form-check-label" for="givenUser">Użytkownik ze strony:</label>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="userName">Imię:</label>
                        <input class="form-control" type="text" id="userName"/>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="userSurname">Nazwisko:</label>
                        <input class="form-control" type="text" id="userSurname"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="avatar">Avatar:</label>
                    <input class="form-control" type="text" id="avatar"/>
                </div>
                <p>Rodzaj widgetu:</p>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" name="widgetType" type="radio" id="sqareWidget"/>
                    <label class="form-check-label" for="sqareWidget">Kwadratowy</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" name="widgetType" type="radio" id="roundWidget"/>
                    <label class="form-check-label" for="roundWidget">Okrągły</label>
                </div>
                <div class="row">
                    <button type="button" id="enterChanges">Zatwierdź</button>
                </div>
            </form>
        </div>
        <h3>Przykładowa treść</h3>
        <p class="lead">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque tristique commodo diam, a venenatis turpis tempor ac. Integer sit amet lectus ex. Phasellus nec dapibus elit, ut auctor nulla. Fusce molestie, leo non ultrices efficitur, arcu libero faucibus leo, id accumsan ex tortor vel nibh. Sed accumsan enim lorem, in maximus tellus dictum at. Praesent at nisi hendrerit, scelerisque nibh sed, tempor eros. Sed suscipit volutpat dignissim. Aenean at velit urna.
            <br />
            Cras laoreet leo in quam varius, a elementum nibh maximus. Integer fringilla scelerisque lectus, non interdum magna dapibus venenatis. Etiam sodales maximus velit, sed congue mauris venenatis quis. Pellentesque tincidunt mollis lacus, non accumsan velit consectetur sit amet. Donec tincidunt a metus ac ornare. Etiam facilisis lectus sit amet imperdiet hendrerit. Donec a semper mauris, vitae cursus elit. Morbi maximus vel erat vel accumsan. Sed tempor magna id nisi rhoncus, eget vestibulum metus interdum. Fusce eget augue consequat, semper augue gravida, vulputate diam.
            <br />
            Interdum et malesuada fames ac ante ipsum primis in faucibus. Fusce egestas aliquam nulla ac viverra. Integer nulla tortor, volutpat in consectetur sed, mollis at odio. Duis risus mauris, fermentum tempus ipsum non, euismod sagittis lectus. Curabitur scelerisque finibus nisi, vitae vehicula mauris maximus eu. In porta aliquet sem in mollis. Donec ullamcorper erat vitae rutrum sollicitudin. Donec posuere congue urna. Etiam finibus at orci in pretium. Fusce vehicula feugiat volutpat. Etiam pretium libero ac justo hendrerit, at vehicula nisi pharetra. Etiam finibus consectetur pharetra. Aenean venenatis blandit eros nec finibus. In viverra risus et tellus convallis, sed porttitor erat molestie. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vivamus elit augue, feugiat mattis aliquet ut, lacinia lacinia tortor.
            <br />
            Sed tempus orci a augue pellentesque, sit amet cursus risus vestibulum. Phasellus elementum ut tellus in aliquam. Vivamus pulvinar dapibus fermentum. Sed ornare porttitor neque. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum ut interdum risus. Donec vitae hendrerit nisi. Praesent fringilla interdum purus eu faucibus.
            <br />
            Pellentesque iaculis tortor ante, eget gravida arcu rhoncus placerat. Mauris dapibus nisl blandit cursus convallis. Etiam viverra luctus nisl, nec auctor ante porttitor id. Vestibulum sollicitudin nisi at efficitur egestas. Aliquam malesuada vitae sem eget tempor. Maecenas eget massa lobortis, pharetra nulla sed, iaculis nunc. Nullam in porta felis. Donec ornare quis est vitae placerat. Pellentesque non quam eget ligula faucibus tempor. Phasellus tristique finibus dolor, eget commodo eros sagittis ac. Morbi auctor ut dolor at tempor. Phasellus vitae vehicula enim. Donec blandit ante a nulla euismod lobortis. Phasellus egestas suscipit libero vel ultrices. Morbi sagittis enim a ligula rutrum, et gravida augue pretium.
            <br />
            Sed feugiat velit id dui varius, et porttitor arcu dictum. Mauris eget purus id justo dignissim ultricies eget a turpis. Proin egestas, tortor in auctor malesuada, tellus lorem vestibulum felis, nec commodo purus enim et tellus. Duis at enim lectus. Ut consequat sagittis nunc, ut consectetur magna dignissim eget. Phasellus elementum consectetur enim, sit amet eleifend quam luctus vitae. Curabitur volutpat lectus eget ipsum convallis, nec bibendum neque commodo. Cras non pellentesque odio, eget pharetra odio. Mauris gravida iaculis mi, ut rhoncus metus fringilla ac.
            <br />
            Sed elementum pretium odio, ac accumsan justo. Proin luctus enim aliquet, sodales nisl sit amet, feugiat quam. Donec ex sem, vestibulum quis metus non, aliquam dapibus magna. Vestibulum ac consequat justo, non iaculis nunc. Suspendisse rutrum velit velit, sit amet tempus ex tempus eget. Donec non aliquam urna, a vestibulum risus. Sed lorem mauris, ullamcorper ac ex at, semper sagittis dolor. Curabitur venenatis vel urna in vulputate. Nullam feugiat congue dolor, ac molestie lorem convallis consectetur. Vestibulum porttitor, risus vel laoreet luctus, tortor mauris cursus nisi, sed ultricies tellus tortor id nisi.
        </p>
    </div>

</div><!-- /.container -->

<footer class="container-fluid">
    <p>Tomasz Bajorek 2018 - 2019</p>
</footer>

<div id="widget"></div>


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"><\/script>')</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://v4-alpha.getbootstrap.com/dist/js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="https://v4-alpha.getbootstrap.com/assets/js/ie10-viewport-bug-workaround.js"></script>

<script src="<%= htmlWebpackPlugin.files.js[0] %>"></script>
<script>
    const fromStorage = localStorage.getItem('widget-example');
    let data;
    const emptyUser = {
        name: 'John',
        surname: 'Stone',
        avatar: 'https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png'
    };
    if(fromStorage !== null) {
        data = JSON.parse(fromStorage);
    } else {
        data = {
            companyId: '3d753167-fb69-4971-9a78-6c04d5e3de8b',
            user: emptyUser,
            button: {
                shape: 'square',
            }
        };
    }
    let user = emptyUser;
    localStorage.setItem('widget-example', JSON.stringify(data));

    document.getElementById('companyId').value = data.companyId;
    document.getElementById('companyId').onchange = function (e) {
        data.companyId = e.target.value;
        localStorage.setItem('widget-example', JSON.stringify(data));

    };
    document.getElementById('givenUser').value = data.user !== null;
    document.getElementById('givenUser').onchange = function (e) {
        if(data.user === null) {
            data.user = user;
            document.getElementById('userName').removeAttribute('disabled');
            document.getElementById('userSurname').removeAttribute('disabled');
            document.getElementById('avatar').removeAttribute('disabled');
        } else {
            user = data.user;
            data.user = null;
            document.getElementById('userName').setAttribute('disabled', true);
            document.getElementById('userSurname').setAttribute('disabled', true);
            document.getElementById('avatar').setAttribute('disabled', true);
        }
        localStorage.setItem('widget-example', JSON.stringify(data));
    };
    document.getElementById('userName').value = (data.user !== null && 'name' in data.user) ? data.user.name : emptyUser.name;
    document.getElementById('userName').onchange = function (e) {
        data.user.name = e.target.value;
        localStorage.setItem('widget-example', JSON.stringify(data));

    };
    document.getElementById('userSurname').value = (data.user !== null && 'surname' in data.user) ? data.user.surname : emptyUser.surname;
    document.getElementById('userSurname').onchange = function (e) {
        data.user.surname = e.target.value;
        localStorage.setItem('widget-example', JSON.stringify(data));

    };
    document.getElementById('avatar').value = (data.user !== null && 'avatar' in data.user) ? data.user.avatar : emptyUser.avatar;
    document.getElementById('avatar').onchange = function (e) {
        data.user.avatar = e.target.value;
        localStorage.setItem('widget-example', JSON.stringify(data));

    };
    document.getElementById('sqareWidget').setAttribute('checked', data.button.shape === 'square');
    document.getElementById('sqareWidget').onchange = function (e) {
        data.button.shape = e.target.value;
        localStorage.setItem('widget-example', JSON.stringify(data));

    };
    document.getElementById('roundWidget').setAttribute('checked', data.button.shape === 'circle');
    document.getElementById('roundWidget').onchange = function (e) {
        data.button.shape = e.target.value;
        localStorage.setItem('widget-example', JSON.stringify(data));

    };

    const initializeWidget = function() {
        // widget initialization
        RtcTalker.initWidget({
            place: '#widget',
            user: data.user,
            channels: ['video', 'audio', 'chat'],
            button: data.button,
            companyId: data.companyId
        });
    };
    initializeWidget();
    document.getElementById('enterChanges').onclick = initializeWidget;
</script>

</body>
</html>